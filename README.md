# 新浪财经API稳定性测试脚本

## 功能介绍

这个脚本用于测试新浪财经API的稳定性和可用性，具体功能包括：

- 🔄 每3秒自动请求一次API
- 📊 实时显示请求结果和股票信息
- 📈 统计成功率、失败率、响应时间等指标
- 📝 自动保存详细日志到JSON文件
- 🎯 专门针对深圳股票sz000498（山东路桥）进行测试

## 测试的API

```
http://hq.sinajs.cn/list=sz000498
```

## 安装依赖

```bash
pip install -r requirements.txt
```

或者直接安装：

```bash
pip install requests
```

## 使用方法

### 运行脚本

```bash
python api_stability_test.py
```

### 停止测试

按 `Ctrl+C` 停止测试

## 输出信息

### 实时显示内容

- 📡 测试API地址
- ⏱️ 更新间隔
- 📝 日志文件名
- 📊 最新请求结果（时间、状态、响应时间）
- 📈 股票信息（股票名称、当前价格、涨跌额、涨跌幅、成交量、买一卖一价格和数量、更新时间）
- 📈 统计信息（运行时间、总请求次数、成功次数、失败次数、成功率、失败率、响应时间统计）

### 统计指标

- **成功率**: 成功请求占总请求的百分比
- **失败率**: 失败请求占总请求的百分比
- **平均响应时间**: 所有请求的平均响应时间
- **最快响应时间**: 最快的一次请求响应时间
- **最慢响应时间**: 最慢的一次请求响应时间
- **响应时间中位数**: 响应时间的中位数

## 日志文件

脚本会自动生成带时间戳的JSON日志文件，格式如：`log_20231201_143022.json`

日志文件包含：
- 测试配置信息
- 统计汇总数据
- 每次请求的详细结果

## 示例输出

```
================================================================================
🔍 新浪财经API稳定性测试
================================================================================
📡 测试API: http://hq.sinajs.cn/list=sz000498
⏱️  更新间隔: 3秒
📝 日志文件: log_20231201_143022.json

📊 最新请求结果:
----------------------------------------
时间: 2023-12-01T14:30:25.123456
状态: 成功
响应时间: 156.78ms

📈 股票信息:
  股票名称: 山东路桥
  当前价格: 5.67
  涨跌额: +0.12
  涨跌幅: +2.16%
  今日最高: 5.89
  今日最低: 5.45
  成交量: 1234567
  成交金额: 7890123.000
  买一价: 5.66
  买一量: 123400
  卖一价: 5.67
  卖一量: 98700
  更新时间: 2023-12-01 14:30:22

📈 统计信息:
----------------------------------------
运行时间: 0:05:30
总请求次数: 110
成功次数: 108
失败次数: 2
成功率: 98.18%
失败率: 1.82%
平均响应时间: 145.67ms
最快响应时间: 89.23ms
最慢响应时间: 2345.67ms
响应时间中位数: 134.56ms

💡 按 Ctrl+C 停止测试
================================================================================
```

## 注意事项

1. 确保网络连接正常
2. 脚本会持续运行直到手动停止
3. 每10次请求会自动保存一次日志
4. 停止测试时会保存最终的完整日志
5. 如果API返回格式发生变化，可能需要调整解析逻辑 